(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[13],{3308:function(e,t,l){Promise.resolve().then(l.bind(l,1194))},1194:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return Home}});var s=l(7437),a=l(2265),r=l(3753),n=l(1174),i=l(9543),c=l(2668),o=l(664),tabs=e=>{let{prefix:t,defaultActiveKey:l,items:r,buttons:n,onSelectTab:i}=e,[c,o]=(0,a.useState)(l),d={borderBottom:"white",color:"#1890FF",fontWeight:"bold",background:"white"},m=r.find(e=>e.key===c),onSelectTabItem=(e,t)=>{o(e),i&&i(t)};return(0,s.jsxs)("div",{className:"h-full w-full flex flex-col justify-start",children:[(0,s.jsxs)("div",{className:"flex flex-row z-10 justify-between",children:[(0,s.jsxs)("div",{className:"flex flex-row",children:[t&&(0,s.jsx)("div",{className:"mb-[-1px] px-3 py-2 border border-solid border-[#1890FF] font-bold text-white bg-[#1890FF]",children:t},"prefix"),r.map((e,t)=>(0,s.jsx)("div",{className:"mb-[-1px] ml-[-1px] first:ml-[0px] px-3 py-1 text-sm border border-solid border-gray-300 ".concat(r.length>1?"first:border-r-0":""," bg-gray-100 cursor-pointer"),style:e.key===c?d:{},onClick:()=>onSelectTabItem(e.key,t),children:e.label},e.key))]}),(0,s.jsx)("div",{className:"flex flex-row items-center space-x-2",children:null==n?void 0:n.map((e,t)=>(0,s.jsx)("div",{children:e},t))})]}),(0,s.jsx)("div",{className:"bg-white border border-solid border-gray-300 overflow-y-auto",style:{height:"calc(100% - 70px)"},children:null==m?void 0:m.children})]})},d=l(4436);let read=async e=>{try{var t;let l=new d.Mr(new d.Nt(e)),s=await l.getEntries(),a=s.find(e=>"content.json"===e.filename),r=await (null==a?void 0:null===(t=a.getData)||void 0===t?void 0:t.call(a,new d.Ek));return r?JSON.parse(r):void 0}catch(e){return}},genSql=e=>{let t=[],l=splitTree(e.item);return l.forEach(e=>{t.push(genSqlForTable(e))}),t},splitTree=e=>{let t=[];return e.children&&e.children.length>0&&e.isMultiple&&t.push(e),e.children&&e.children.forEach(e=>{let l=splitTree(e);t.push(...l)}),t},m="PARENT",genSqlForTable=e=>{let t={item:e,columns:[],tables:[],joins:[],conditions:[]};processParentRelationship(e,t),pushIfNotExists(t.columns,getColumnsOfItem(e,!0));let l=fixColumns(t.columns,e);return t.columns=l,dfs(e,t),result2sql(t)},fixColumns=(e,t)=>{let l=getAliasOrName(t);return e.includes("".concat(l,".*"))?e.filter(e=>!e.startsWith("".concat(l,"."))||e==="".concat(l,".*")):e},getColumnsOfItem=(e,t)=>e.children?e.children.filter(e=>!e.children).map(t=>"".concat(getAliasOrName(e),".").concat(getAliasOrName(t))):t?["".concat(getAliasOrName(e),".*")]:[],refs2conditions=(e,t,l)=>e.map(e=>{let s=-1!==e[1].indexOf(".")?e[1]:"".concat(l,".").concat(e[1]);return"".concat(t,".").concat(e[0]," = ").concat(s)}),processParentRelationship=(e,t)=>{let{columns:l,tables:s,conditions:a}=t;if(e.refs&&e.refs.length>0){s.push("___DUMMY___ ".concat(m));let t=refs2conditions(e.refs,m,getAliasOrName(e));pushIfNotExists(a,t);let r=refs2columns(e.refs,getAliasOrName(e));pushIfNotExists(l,r)}},refs2columns=(e,t)=>e.map(e=>{let l=-1!==e[1].indexOf(".")?e[1]:"".concat(t,".").concat(e[1]);return"".concat(l)}),dfs=(e,t)=>{if(!e.children)return;pushIfNotExists(t.columns,getColumnsOfItem(e));let l=e.children.filter(e=>e.children);l.forEach(l=>{if(!l.isMultiple){if(l.refs&&l.refs.length>0){let s=refs2conditions(l.refs,getAliasOrName(e),getAliasOrName(l)),a="LEFT JOIN ".concat(getTableAndAlias(l)," ON ").concat(s.join(" AND "));t.joins.push(a)}else t.tables.push(getTableAndAlias(l));dfs(l,t)}})},result2sql=e=>{let{item:t,columns:l,tables:s,joins:a,conditions:r}=e,n=l.join(", "),i=["".concat(getTableAndAlias(t)," ").concat(a.join(" ")),...s].join(", "),c=r.length>0?"WHERE ".concat(r.join(" AND ")):"",o="SELECT ".concat(n," FROM ").concat(i," ").concat(c);return o.replace(/\s+/g," ").replace(/\s+,\s+/g,", ").trim()},getAliasOrName=e=>e.alias||e.name,getTableAndAlias=e=>e.alias?"".concat(e.name," ").concat(e.alias):e.name,pushIfNotExists=(e,t)=>{t.forEach(t=>{e.includes(t)||e.push(t)})},topic2item=e=>{let t=e.id,l={id:t,name:""},s=e.title.indexOf("/");-1===s?l.name=e.title:(l.name=e.title.substring(0,s).trim(),l.comment=e.title.substring(s+1).trim()),l.name=l.name.replaceAll(" ",""),l.name.endsWith("[]")&&(l.name=l.name.substring(0,l.name.length-2),l.isMultiple=!0);let a=/(.*)\((.*)\)/.exec(l.name);a&&(""!==a[1]&&(l.name=a[1]),""!==a[2]&&(l.alias=a[2])),e.labels&&(l.refs=e.labels.map(e=>{let t=e.replace(" ",""),l=t.split("=");return 2===l.length?l:[l[0],l[0]]}));let r=parseChildrenTopics(e);return r&&r.length>0&&(l.children=r),l},parseChildrenTopics=e=>{var t;if(!(null===(t=e.children)||void 0===t?void 0:t.attached))return;let l=[];return e.children.attached.forEach(e=>{let t=topic2item(e);l.push(t)}),l},parse=async e=>{if(!e)return{code:-1,message:"file is null"};let t=await read(e),l=null==t?void 0:t.map(e=>{let t={id:e.id,name:e.title,item:topic2item(e.rootTopic)},l=genSql(t);return{business:t,sqls:l}});return l?{code:0,message:"success",result:l,filename:e.name}:{code:-2,message:"Failed reading from xmind! Not a Xmind file?"}};l(4040);var x=l(4860);function Modal(e){let{title:t,onClose:l,children:a,actions:r}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"absolute top-0 left-0 right-0 bottom-0 z-50 bg-black opacity-70"}),(0,s.jsx)("div",{className:"absolute top-0 left-0 z-50 w-screen h-screen flex justify-center items-center",children:(0,s.jsxs)("div",{className:"w-3/4 flex flex-col border shadow-md bg-white rounded-lg p-2 overflow-auto",style:{maxWidth:"80%",maxHeight:"90%"},children:[(0,s.jsxs)("div",{className:"min-w-96 flex items-center justify-between border-b border-b-gray-300 p-2",children:[(0,s.jsx)("div",{className:"font-bold text-gray-900 text-base",children:t}),(0,s.jsx)("div",{className:"cursor-pointer hover:brightness-125",onClick:l,children:(0,s.jsx)(x.Z,{name:"close",color:"#000000"})})]}),(0,s.jsx)("div",{className:"p-2 overflow-auto",children:a}),r&&r.length>0&&(0,s.jsx)("div",{className:"w-full flex justify-center border-t border-t-gray-300 p-2 pt-4",children:(0,s.jsx)("div",{className:"flex items-center",children:null==r?void 0:r.map((e,t)=>(0,s.jsx)("div",{className:"!last:mr-20",children:e},t))})})]})})]})}var u=l(3574),f=l.n(u),h=l(2776);function Home(){var e;let[t,l]=(0,a.useState)(),[d,m]=(0,a.useState)(!0),[x,u]=(0,a.useState)([]);(0,h.Z)("SQLGen");let onProcess=async e=>{if(!e){alert("No file selected");return}let t=await parse(e);t.code>=0&&(l(t),m(!0))};return(0,a.useEffect)(()=>{if((null==t?void 0:t.code)===0){var e;let l=[];null===(e=t.result)||void 0===e||e.forEach((e,t)=>{let{business:a,sqls:n}=e,i={label:a.name,key:t.toString(),children:(0,s.jsx)("div",{className:"px-4 py-2",children:n.map((e,t)=>(0,s.jsx)("div",{className:"my-2",children:(0,s.jsx)(o.Z,{lang:"sql",code:(0,r.WU)(e)})},t))})};l.push(i)}),u(l)}},[t]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f(),{children:(0,s.jsx)("title",{children:"SQLGen"})}),(0,s.jsxs)("main",{className:"w-full flex flex-col items-center",style:{height:"calc(100vh - 24px)"},children:[(0,s.jsx)(i.Z,{logo:"/sqlgen.png",name:"SQLGen"}),(0,s.jsxs)("div",{className:"w-full h-full flex flex-col items-center justify-center pt-10 pb-24",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center mb-16 space-y-2 cursor-default",children:[(0,s.jsxs)("h1",{className:"font-bold text-7xl",children:[(0,s.jsx)("span",{className:"text-[#057bff]",children:"SQL"}),(0,s.jsx)("span",{className:"text-[#ff9102]",children:"Gen"}),(0,s.jsx)("span",{className:"text-4xl text-gray-400",children:" with"}),(0,s.jsx)("span",{className:"text-4xl",children:" Mindmap"})]}),(0,s.jsx)("span",{className:"text-xl text-thin text-gray-400",children:"for extracting data from Database"})]}),(0,s.jsx)(c.Z,{title:"XMind File",suffix:"xmind",onProcess:onProcess})]}),(0,s.jsx)(n.Z,{company:"军事医学研究院"})]}),d&&t&&(0,s.jsx)(Modal,{title:null!==(e=null==t?void 0:t.filename)&&void 0!==e?e:"",onClose:()=>m(!1),children:(0,s.jsx)(tabs,{defaultActiveKey:"0",items:x})})]})}},1174:function(e,t,l){"use strict";var s=l(7437);t.Z=e=>{let{company:t}=e;return(0,s.jsx)("div",{className:"w-full h-32 flex items-center justify-center bottom-0 border-t border-t-gray-100",children:(0,s.jsxs)("div",{className:"text-gray-400",children:["\xa9 ",new Date().getFullYear()," ",t]})})}},9543:function(e,t,l){"use strict";var s=l(7437),a=l(6691),r=l.n(a),n=l(4860);t.Z=e=>{let{logo:t,name:l}=e;return(0,s.jsxs)("div",{className:"fixed w-full flex items-center justify-between h-12 shadow-md bg-white",children:[(0,s.jsxs)("div",{className:"flex flex-row items-center space-x-10 ml-6",children:[(0,s.jsxs)("div",{className:"flex flex-row items-center space-x-2",children:[(0,s.jsx)(r(),{src:t,alt:"SQLGen",width:"24",height:"24"}),(0,s.jsx)("span",{children:l})]}),(0,s.jsx)("div",{className:"flex flex-row items-center space-x-4"})]}),(0,s.jsxs)("div",{className:"flex flex-row items-center space-x-2 mr-6",children:[(0,s.jsx)(n.Z,{name:"download"}),(0,s.jsx)(n.Z,{name:"settings"})]})]})}},2668:function(e,t,l){"use strict";var s=l(7437),a=l(4860);t.Z=e=>{let{title:t,suffix:l,onProcess:r}=e,handleUpload=async e=>{var t;e.preventDefault();let l=null===(t=e.target.files)||void 0===t?void 0:t[0];await r(l),e.target.value=""};return(0,s.jsxs)("label",{htmlFor:"dropzone-file",className:"mx-auto cursor-pointer flex w-full max-w-lg flex-col items-center rounded-xl border-2 border-dashed border-blue-400 bg-white p-6 text-center",children:[(0,s.jsx)(a.Z,{name:"upload",size:32,color:"#057bff"}),(0,s.jsx)("h2",{className:"mt-4 text-xl font-medium text-gray-700 tracking-wide",children:t}),(0,s.jsxs)("p",{className:"mt-2 text-gray-500 tracking-wide",children:["Click and upload your ",l," file here."]}),(0,s.jsx)("input",{id:"dropzone-file",type:"file",accept:".".concat(l),className:"hidden",onChange:handleUpload})]})}},2776:function(e,t,l){"use strict";var s=l(2265);t.Z=e=>{(0,s.useEffect)(()=>{document.title=e},[e])}},664:function(e,t,l){"use strict";var s=l(7437),a=l(2265),r=l(3152),n=l(4042),i=l(4860);l(2995),r.Z.registerLanguage("javascript",n.Z),t.Z=e=>{let{lang:t,code:l}=e,n=(0,a.useRef)(null);return(0,a.useEffect)(()=>{n.current&&r.Z.highlightBlock(n.current)},[l]),(0,s.jsxs)("div",{className:"border rounded-md",children:[(0,s.jsxs)("div",{className:"flex flex-row items-center justify-between rounded-t-md text-xs text-gray-200 bg-gray-800 px-4 py-2",children:[(0,s.jsx)("div",{className:"",children:t}),(0,s.jsxs)("button",{className:"flex flex-row space-x-1 rounded-md px-2",onClick:()=>{let e=n.current;if(e){let t=document.createRange();t.selectNodeContents(e);let l=window.getSelection();null==l||l.removeAllRanges(),null==l||l.addRange(t),document.execCommand("copy")}},children:[(0,s.jsx)(i.Z,{name:"copy"})," ",(0,s.jsx)("span",{children:"Copy code"})]})]}),(0,s.jsx)("pre",{className:"",children:(0,s.jsx)("code",{ref:n,className:"rounded-b-md ".concat(t),children:l})})]})}},4860:function(e,t,l){"use strict";l.d(t,{Z:function(){return icon}});var s=l(7437);let a=(0,s.jsx)("path",{d:"M19.8 4.2a1 1 0 1 0-1.4-1.4L12 10.6 5.6 4.2a1 1 0 1 0-1.4 1.4L10.6 12l-6.4 6.4a1 1 0 1 0 1.4 1.4L12 13.4l6.4 6.4a1 1 0 1 0 1.4-1.4L13.4 12l6.4-6.4z"}),r=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),(0,s.jsx)("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"})]}),n=(0,s.jsx)("path",{d:"M14.7928932,11.5 L11.6464466,8.35355339 C11.4511845,8.15829124 11.4511845,7.84170876 11.6464466,7.64644661 C11.8417088,7.45118446 12.1582912,7.45118446 12.3535534,7.64644661 L16.3535534,11.6464466 C16.5488155,11.8417088 16.5488155,12.1582912 16.3535534,12.3535534 L12.3535534,16.3535534 C12.1582912,16.5488155 11.8417088,16.5488155 11.6464466,16.3535534 C11.4511845,16.1582912 11.4511845,15.8417088 11.6464466,15.6464466 L14.7928932,12.5 L4,12.5 C3.72385763,12.5 3.5,12.2761424 3.5,12 C3.5,11.7238576 3.72385763,11.5 4,11.5 L14.7928932,11.5 Z M16,4.5 C15.7238576,4.5 15.5,4.27614237 15.5,4 C15.5,3.72385763 15.7238576,3.5 16,3.5 L19,3.5 C20.3807119,3.5 21.5,4.61928813 21.5,6 L21.5,18 C21.5,19.3807119 20.3807119,20.5 19,20.5 L16,20.5 C15.7238576,20.5 15.5,20.2761424 15.5,20 C15.5,19.7238576 15.7238576,19.5 16,19.5 L19,19.5 C19.8284271,19.5 20.5,18.8284271 20.5,18 L20.5,6 C20.5,5.17157288 19.8284271,4.5 19,4.5 L16,4.5 Z",transform:"rotate(90 12.5 12)"}),i=(0,s.jsx)("path",{d:"M9.405 1.05c-.413-1.4-2.397-1.4-2.81 0l-.1.34a1.464 1.464 0 0 1-2.105.872l-.31-.17c-1.283-.698-2.686.705-1.987 1.987l.169.311c.446.82.023 1.841-.872 2.105l-.34.1c-1.4.413-1.4 2.397 0 2.81l.34.1a1.464 1.464 0 0 1 .872 2.105l-.17.31c-.698 1.283.705 2.686 1.987 1.987l.311-.169a1.464 1.464 0 0 1 2.105.872l.1.34c.413 1.4 2.397 1.4 2.81 0l.1-.34a1.464 1.464 0 0 1 2.105-.872l.31.17c1.283.698 2.686-.705 1.987-1.987l-.169-.311a1.464 1.464 0 0 1 .872-2.105l.34-.1c1.4-.413 1.4-2.397 0-2.81l-.34-.1a1.464 1.464 0 0 1-.872-2.105l.17-.31c.698-1.283-.705-2.686-1.987-1.987l-.311.169a1.464 1.464 0 0 1-2.105-.872l-.1-.34zM8 10.93a2.929 2.929 0 1 1 0-5.86 2.929 2.929 0 0 1 0 5.858z"}),c=(0,s.jsx)("path",{d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"});var o={close:{viewBox:"0 0 24 24",scale:.8,path:a,fill:!0,stroke:2},copy:{viewBox:"0 0 24 24",scale:.8,path:r,fill:!1,stroke:2},download:{viewBox:"0 0 24 24",scale:.9,path:n,fill:!0,stroke:.8},settings:{viewBox:"0 0 16 16",scale:.8,path:i,fill:!1,stroke:!0},upload:{viewBox:"0 0 24 24",scale:.9,path:c,fill:!1,stroke:2}},icon=e=>{let{name:t,size:l=20,color:a,onClick:r}=e,n=o[t]||{},i=n.scale||1;return(0,s.jsx)("div",{style:{color:a},onClick:r,children:(0,s.jsx)("svg",{width:l*i,height:l*i,strokeWidth:n.stroke&&0!==n.stroke?"".concat(n.stroke):"1.5",stroke:!1===n.stroke||0===n.stroke?"transparent":"currentColor",strokeLinecap:"round",strokeLinejoin:"round",fill:n.fill?"currentColor":"transparent",viewBox:n.viewBox||"0 0 32 32",children:n.path})})}}},function(e){e.O(0,[962,940,971,472,744],function(){return e(e.s=3308)}),_N_E=e.O()}]);